ggplot(pre2011_subset_data, aes(x = DATE, y = total_generation_source)) +
geom_line(color = "darkblue", size=0.6) +
labs(x = "Time",
y = "Total Energy Generation (MWh)") +
theme_minimal() +
scale_x_continuous(breaks = seq(min(pre2011_subset_data$DATE), max(pre2011_subset_data$DATE), by = "year"),
labels = format(seq(min(pre2011_subset_data$DATE), max(pre2011_subset_data$DATE), by = "year"),  "%Y"),
expand = c(0, 0)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
# Plot the subset of data before 2011
ggplot(pre2011_subset_data, aes(x = DATE, y = total_generation_source)) +
geom_line(color = "darkblue", size=0.6) +
geom_smooth(method = "loess", color = "red", size = 1)+
labs(x = "Time",
y = "Total Energy Generation (MWh)") +
theme_minimal() +
scale_x_continuous(breaks = seq(min(pre2011_subset_data$DATE), max(pre2011_subset_data$DATE), by = "year"),
labels = format(seq(min(pre2011_subset_data$DATE), max(pre2011_subset_data$DATE), by = "year"),  "%Y"),
expand = c(0, 0)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
# Plot the subset of data before 2011
ggplot(pre2011_subset_data, aes(x = DATE, y = total_generation_source)) +
geom_line(color = "darkblue", size=0.6) +
labs(x = "Time",
y = "Total Energy Generation (MWh)") +
theme_minimal() +
scale_x_continuous(breaks = seq(min(pre2011_subset_data$DATE), max(pre2011_subset_data$DATE), by = "year"),
labels = format(seq(min(pre2011_subset_data$DATE), max(pre2011_subset_data$DATE), by = "year"),  "%Y"),
expand = c(0, 0)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
# Plot the subset of data before 2011
ggplot(pre2011_subset_data, aes(x = DATE, y = total_generation_source)) +
geom_line(color = "darkblue", size=0.6) +
geom_smooth(method = "loess", color = "red", size = 1, span = 0.5) +  # Adjust span
labs(x = "Time",
y = "Total Energy Generation (MWh)") +
theme_minimal() +
scale_x_continuous(breaks = seq(min(pre2011_subset_data$DATE), max(pre2011_subset_data$DATE), by = "year"),
labels = format(seq(min(pre2011_subset_data$DATE), max(pre2011_subset_data$DATE), by = "year"),  "%Y"),
expand = c(0, 0)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
# Plot the subset of data before 2011
ggplot(pre2011_subset_data, aes(x = DATE, y = total_generation_source)) +
geom_line(color = "darkblue", size=0.6) +
geom_smooth(method = "loess", color = "red", size = 1, span = 0.9) +  # Adjust span
labs(x = "Time",
y = "Total Energy Generation (MWh)") +
theme_minimal() +
scale_x_continuous(breaks = seq(min(pre2011_subset_data$DATE), max(pre2011_subset_data$DATE), by = "year"),
labels = format(seq(min(pre2011_subset_data$DATE), max(pre2011_subset_data$DATE), by = "year"),  "%Y"),
expand = c(0, 0)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
# Plot the subset of data before 2011
ggplot(pre2011_subset_data, aes(x = DATE, y = total_generation_source)) +
geom_line(color = "darkblue", size=0.6) +
geom_smooth(method = "loess", color = "red", size = 1, span = 0.1) +  # Adjust span
labs(x = "Time",
y = "Total Energy Generation (MWh)") +
theme_minimal() +
scale_x_continuous(breaks = seq(min(pre2011_subset_data$DATE), max(pre2011_subset_data$DATE), by = "year"),
labels = format(seq(min(pre2011_subset_data$DATE), max(pre2011_subset_data$DATE), by = "year"),  "%Y"),
expand = c(0, 0)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
# Plot the subset of data before 2011
ggplot(pre2011_subset_data, aes(x = DATE, y = total_generation_source)) +
geom_line(color = "darkblue", size=0.6) +
geom_smooth(method = "loess", color = "red", size = 1, span = 0.3) +  # Adjust span
labs(x = "Time",
y = "Total Energy Generation (MWh)") +
theme_minimal() +
scale_x_continuous(breaks = seq(min(pre2011_subset_data$DATE), max(pre2011_subset_data$DATE), by = "year"),
labels = format(seq(min(pre2011_subset_data$DATE), max(pre2011_subset_data$DATE), by = "year"),  "%Y"),
expand = c(0, 0)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
# Plot the subset of data before 2011
ggplot(pre2011_subset_data, aes(x = DATE, y = total_generation_source)) +
geom_line(color = "darkblue", size=0.6) +
geom_smooth(method = "loess", color = "red", size = 1, span = 0.2) +  # Adjust span
labs(x = "Time",
y = "Total Energy Generation (MWh)") +
theme_minimal() +
scale_x_continuous(breaks = seq(min(pre2011_subset_data$DATE), max(pre2011_subset_data$DATE), by = "year"),
labels = format(seq(min(pre2011_subset_data$DATE), max(pre2011_subset_data$DATE), by = "year"),  "%Y"),
expand = c(0, 0)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
# Subset data for dates starting from 2011
post2011_subset_data <- data[data$DATE >= as.Date("2011-01-01"), ]
# Plot the subset of data
ggplot(post2011_subset_data, aes(x = DATE, y = total_generation_source)) +
geom_line(color = "darkblue")+
geom_smooth(method = "loess", color = "red", size = 1, span = 0.2) +  # Adjust span
labs(x = "Time",
y = "Total Energy Generation (MWh)") +
theme_minimal() +
scale_x_continuous(breaks = seq(min(post2011_subset_data$DATE), max(post2011_subset_data$DATE), by = "year"),
labels = format(seq(min(post2011_subset_data$DATE), max(post2011_subset_data$DATE), by = "year"),  "%Y"),
expand = c(0, 0)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
# Plot the subset of data
ggplot(post2011_subset_data, aes(x = DATE, y = total_generation_source)) +
geom_line(color = "darkblue")+
geom_smooth(method = "loess", color = "red", size = 1, span = 0.1) +  # Adjust span
labs(x = "Time",
y = "Total Energy Generation (MWh)") +
theme_minimal() +
scale_x_continuous(breaks = seq(min(post2011_subset_data$DATE), max(post2011_subset_data$DATE), by = "year"),
labels = format(seq(min(post2011_subset_data$DATE), max(post2011_subset_data$DATE), by = "year"),  "%Y"),
expand = c(0, 0)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
# Plot the subset of data
ggplot(post2011_subset_data, aes(x = DATE, y = total_generation_source)) +
geom_line(color = "darkblue")+
geom_smooth(method = "loess", color = "red", size = 1, span = 0.2) +  # Adjust span
labs(x = "Time",
y = "Total Energy Generation (MWh)") +
theme_minimal() +
scale_x_continuous(breaks = seq(min(post2011_subset_data$DATE), max(post2011_subset_data$DATE), by = "year"),
labels = format(seq(min(post2011_subset_data$DATE), max(post2011_subset_data$DATE), by = "year"),  "%Y"),
expand = c(0, 0)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
# Plot the subset of data
ggplot(post2011_subset_data, aes(x = DATE, y = total_generation_source)) +
geom_line(color = "darkblue")+
geom_smooth(method = "loess", color = "red", size = 1, span = 0.2) +  # Adjust span
labs(x = "Time",
y = "Total Energy Generation (MWh)") +
theme_minimal() +
scale_x_continuous(breaks = seq(min(post2011_subset_data$DATE), max(post2011_subset_data$DATE), by = "year"),
labels = format(seq(min(post2011_subset_data$DATE), max(post2011_subset_data$DATE), by = "year"),  "%Y"),
expand = c(0, 0)) +
scale_y_continuous(limits = c(0, 90000), breaks = seq(0, 90000, by = 5000))+
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
# Subset data for dates starting from 2011
post2011_subset_data <- data[data$DATE >= as.Date("2011-01-01"), ]
# Plot the subset of data
ggplot(post2011_subset_data, aes(x = DATE, y = total_generation_source)) +
geom_line(color = "darkblue")+
geom_smooth(method = "loess", color = "red", size = 1, span = 0.2) +  # Adjust span
labs(x = "Time",
y = "Total Energy Generation (MWh)") +
theme_minimal() +
scale_x_continuous(breaks = seq(min(post2011_subset_data$DATE), max(post2011_subset_data$DATE), by = "year"),
labels = format(seq(min(post2011_subset_data$DATE), max(post2011_subset_data$DATE), by = "year"),  "%Y"),
expand = c(0, 0)) +
scale_y_continuous(limits = c(0, 90000), breaks = seq(0, 90000, by = 5000))+
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
library(lubridate)
library(ggplot2)
library(dplyr)
# Average monthly energy generation from all producers all years
avg_data <- data %>%
group_by(month = factor(month)) %>%
summarise(avg_generation = mean(total_generation_source, na.rm = TRUE)) %>%
mutate(highlight_flag = ifelse(avg_generation > 10000, TRUE, FALSE))
avg_data$energysource = 'All'
ggplot(avg_data, aes(x = factor(month), y = avg_generation, fill = as.character(highlight_flag))) +
geom_bar(stat = "identity", color = "darkblue") +
labs(x = "Month", y = "Avg. Generation (MWh)", fill = "Generation") +
scale_fill_manual(values = c("FALSE" = "lightblue", "TRUE" = 'blue'), labels = c('Other seasons', 'Summer')) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
text = element_text(hjust = 1, family = 'Helvetica Neue'),
title = element_text(face = 'bold')
) +
scale_y_continuous(limits = c(0, 40000), breaks = seq(0, 40000, by = 5000))+
geom_text(data = filter(avg_data, month == "lug"),
aes(x = month, y = avg_generation, label = round(avg_generation)),
vjust = -0.5, color = "black", size = 6)
# Average monthly energy generation
avg_data <- data %>%
group_by(month = factor(month)) %>%
summarise(avg_generation = mean(total_generation_source, na.rm = TRUE)) %>%
mutate(highlight_flag = ifelse(avg_generation > 10000, TRUE, FALSE))
avg_data$energysource = 'All'
ggplot(avg_data, aes(x = factor(month), y = avg_generation, fill = as.character(highlight_flag))) +
geom_bar(stat = "identity", color = "darkblue") +
labs(x = "Month", y = "Avg. Generation (MWh)", fill = "Generation") +
scale_fill_manual(values = c("FALSE" = "lightblue", "TRUE" = 'blue'), labels = c('Other seasons', 'Summer')) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
text = element_text(hjust = 1, family = 'Helvetica Neue'),
title = element_text(face = 'bold')
) +
scale_y_continuous(limits = c(0, 40000), breaks = seq(0, 40000, by = 5000))+
geom_text(data = filter(avg_data, month == "lug"),
aes(x = month, y = avg_generation, label = round(avg_generation)),
vjust = -0.5, color = "black", size = 6)
# Average monthly energy generation from petroleum pre 2011
pre2011_avg_pet_data <- pre2011_subset_data %>%
group_by(month) %>%
summarise(avg_generation = mean(Petroleum, na.rm = TRUE)) %>%
mutate(highlight_flag = ifelse(avg_generation > 10000, TRUE, FALSE))
pre2011_avg_pet_data$energysource = 'Petroleum'
ggplot(pre2011_avg_pet_data, aes(x = factor(month), y = avg_generation, fill = as.character(highlight_flag))) +
geom_bar(stat = "identity", color = "darkblue") +
labs(x = "Month", y = "Avg. Generation (MWh)", fill = "Petroleum usage") +
scale_fill_manual(values = c("FALSE" = "lightblue", "TRUE" = '#f16161'), labels = c('Other seasons', 'Summer')) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
text = element_text(hjust = 1, family = 'Helvetica Neue'),
title = element_text(face = 'bold')
) +
scale_y_continuous(limits = c(0, 40000), breaks = seq(0, 40000, by = 5000))+
geom_text(data = filter(pre2011_avg_pet_data, month == "ago"),
aes(x = month, y = avg_generation, label = round(avg_generation)),
vjust = -0.5, color = "black", size = 6)
# Average monthly energy generation
avg_data <- data %>%
group_by(month = factor(month)) %>%
summarise(avg_generation = mean(total_generation_source, na.rm = TRUE)) %>%
mutate(highlight_flag = ifelse(avg_generation > 10000, TRUE, FALSE))
avg_data$energysource = 'All'
ggplot(avg_data, aes(x = factor(month), y = avg_generation, fill = as.character(highlight_flag))) +
geom_bar(stat = "identity", color = "darkblue") +
labs(x = "Month", y = "Avg. Generation (MWh)", fill = "Generation") +
scale_fill_manual(values = c("FALSE" = "lightblue", "TRUE" = 'blue'), labels = c('Other seasons', 'Summer')) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
text = element_text(hjust = 1, family = 'Helvetica Neue'),
title = element_text(face = 'bold')
) +
scale_y_continuous(limits = c(0, 40000), breaks = seq(0, 40000, by = 5000))+
geom_text(data = filter(avg_data, month == "lug"),
aes(x = month, y = avg_generation, label = round(avg_generation)),
vjust = -0.5, color = "black", size = 6)
ggplot(avg_data, aes(x = factor(month), y = avg_generation, fill = as.character(highlight_flag))) +
geom_bar(stat = "identity", color = "darkblue") +
labs(x = "Month", y = "Avg. Generation (MWh)", fill = "Generation") +
scale_fill_manual(values = c("FALSE" = "lightblue", "TRUE" = '#3e6fff'), labels = c('Other seasons', 'Summer')) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
text = element_text(hjust = 1, family = 'Helvetica Neue'),
title = element_text(face = 'bold')
) +
scale_y_continuous(limits = c(0, 40000), breaks = seq(0, 40000, by = 5000))+
geom_text(data = filter(avg_data, month == "lug"),
aes(x = month, y = avg_generation, label = round(avg_generation)),
vjust = -0.5, color = "black", size = 6)
ggplot(pre2011_avg_pet_data, aes(x = factor(month), y = avg_generation, fill = as.character(highlight_flag))) +
geom_bar(stat = "identity", color = "darkblue") +
labs(x = "Month", y = "Avg. Generation (MWh)", fill = "Petroleum usage") +
scale_fill_manual(values = c("FALSE" = "lightblue", "TRUE" = '#3e6fff'), labels = c('Other seasons', 'Summer')) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
text = element_text(hjust = 1, family = 'Helvetica Neue'),
title = element_text(face = 'bold')
) +
scale_y_continuous(limits = c(0, 40000), breaks = seq(0, 40000, by = 5000))+
geom_text(data = filter(pre2011_avg_pet_data, month == "ago"),
aes(x = month, y = avg_generation, label = round(avg_generation)),
vjust = -0.5, color = "black", size = 6)
# Average monthly energy generation from renewables sources post 2011
post2011_avg_ren_data <- post2011_subset_data %>%
group_by(month) %>%
summarise(avg_generation = mean(total_renew_source, na.rm = TRUE)) %>%
mutate(highlight_flag = ifelse(avg_generation > 3600, TRUE, FALSE))
ggplot(post2011_avg_ren_data, aes(x = factor(month), y = avg_generation, fill = as.character(highlight_flag))) +
geom_bar(stat = "identity", color = "darkblue") +
labs(x = "Month", y = "Avg. Generation (MWh)", fill = "Renewables usage") +
scale_fill_manual(values = c("FALSE" = "lightblue", "TRUE" = '#3e6fff'), labels = c('Normal', 'Highest')) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
text = element_text(hjust = 1, family = 'Helvetica Neue'),
title = element_text(face = 'bold')
) +
scale_y_continuous(limits = c(0, 5000), breaks = seq(0, 5000, by = 1000))+
geom_text(data = filter(post2011_avg_ren_data, month == "dec"),
aes(x = month, y = avg_generation, label = round(avg_generation)),
vjust = -0.5, color = "black", size = 6)
# Average monthly energy generation from renewables sources post 2011
post2011_avg_ren_data <- post2011_subset_data %>%
group_by(month) %>%
summarise(avg_generation = mean(total_renew_source, na.rm = TRUE)) %>%
mutate(highlight_flag = ifelse(avg_generation > 3500, TRUE, FALSE))
post2011_avg_ren_data$energysource = 'Renewables'
ggplot(post2011_avg_ren_data, aes(x = factor(month), y = avg_generation, fill = as.character(highlight_flag))) +
geom_bar(stat = "identity", color = "darkblue") +
labs(x = "Month", y = "Avg. Generation (MWh)", fill = "Renewables usage") +
scale_fill_manual(values = c("FALSE" = "lightblue", "TRUE" = '#3e6fff'), labels = c('Normal', 'Highest')) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
text = element_text(hjust = 1, family = 'Helvetica Neue'),
title = element_text(face = 'bold')
) +
scale_y_continuous(limits = c(0, 5000), breaks = seq(0, 5000, by = 1000))+
geom_text(data = filter(post2011_avg_ren_data, month == "dec"),
aes(x = month, y = avg_generation, label = round(avg_generation)),
vjust = -0.5, color = "black", size = 6)
# Average monthly energy generation from solar
# solar data (starting in 2019)
solar_data <- subset(data, Solar.Thermal.and.Photovoltaic > 0)
avg_solar_data <- solar_data %>%
group_by(month) %>%
summarise(avg_generation = mean(Solar.Thermal.and.Photovoltaic, na.rm = TRUE)) %>%
mutate(highlight_flag = ifelse(avg_generation > 1600, TRUE, FALSE))
ggplot(avg_solar_data, aes(x = factor(month), y = avg_generation, fill = as.character(highlight_flag))) +
geom_bar(stat = "identity", color = "darkblue") +
labs(x = "Month", y = "Avg. Generation (MWh)", fill = "Renewables usage") +
scale_fill_manual(values = c("FALSE" = "lightblue", "TRUE" = '#f16161'), labels = c('Normal', 'Highest')) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
text = element_text(hjust = 1, family = 'Helvetica Neue'),
title = element_text(face = 'bold')
) +
scale_y_continuous(limits = c(0, 12000), breaks = seq(0, 12000, by = 2000))+
geom_text(data = filter(avg_solar_data, month == "mag"),
aes(x = month, y = avg_generation, label = round(avg_generation)),
vjust = -0.5, color = "black", size = 6)
ggplot(avg_solar_data, aes(x = factor(month), y = avg_generation, fill = as.character(highlight_flag))) +
geom_bar(stat = "identity", color = "darkblue") +
labs(x = "Month", y = "Avg. Generation (MWh)", fill = "Renewables usage") +
scale_fill_manual(values = c("FALSE" = "lightblue", "TRUE" = '#f16161'), labels = c('Normal', 'Highest')) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
text = element_text(hjust = 1, family = 'Helvetica Neue'),
title = element_text(face = 'bold')
) +
scale_y_continuous(limits = c(0, 12000), breaks = seq(0, 12000, by = 2000))+
geom_text(data = filter(avg_solar_data, month == "mag"),
aes(x = month, y = avg_generation, label = round(avg_generation)),
vjust = -0.5, color = "black", size = 6)
gas_data <- subset(data, Natural.Gas > 0)
avg_gas_data <- gas_data %>%
group_by(month) %>%
summarise(avg_generation = mean(Natural.Gas, na.rm = TRUE)) %>%
mutate(highlight_flag = ifelse(avg_generation > 6500, TRUE, FALSE))
avg_gas_data$energysource = 'Gas'
ggplot(avg_gas_data, aes(x = factor(month), y = avg_generation, fill = as.character(highlight_flag))) +
geom_bar(stat = "identity", color = "darkblue") +
labs(x = "Month", y = "Avg. Generation (MWh)", fill = "Natural Gas usage") +
scale_fill_manual(values = c("FALSE" = "lightblue", "TRUE" = '#f16161'), labels = c('Normal', 'Highest')) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
text = element_text(hjust = 1, family = 'Helvetica Neue'),
title = element_text(face = 'bold')
) +
scale_y_continuous(limits = c(0, 12000), breaks = seq(0, 12000, by = 2000))+
geom_text(data = filter(avg_gas_data, month == "lug"),
aes(x = month, y = avg_generation, label = round(avg_generation)),
vjust = -0.5, color = "black", size = 6)
ggplot(avg_gas_data, aes(x = factor(month), y = avg_generation, fill = as.character(highlight_flag))) +
geom_bar(stat = "identity", color = "darkblue")+
geom_smooth(method = "loess", color = "red", size = 1, span = 0.2) +  # Adjust span
labs(x = "Month", y = "Avg. Generation (MWh)", fill = "Natural Gas usage") +
scale_fill_manual(values = c("FALSE" = "lightblue", "TRUE" = '#f16161'), labels = c('Normal', 'Highest')) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
text = element_text(hjust = 1, family = 'Helvetica Neue'),
title = element_text(face = 'bold')
) +
scale_y_continuous(limits = c(0, 12000), breaks = seq(0, 12000, by = 2000))+
geom_text(data = filter(avg_gas_data, month == "lug"),
aes(x = month, y = avg_generation, label = round(avg_generation)),
vjust = -0.5, color = "black", size = 6)
ggplot(avg_gas_data, aes(x = factor(month), y = avg_generation, fill = as.character(highlight_flag))) +
geom_bar(stat = "identity", color = "darkblue")+
geom_smooth(method = "loess", color = "red", size = 1, span = 0.2) +  # Adjust span
labs(x = "Month", y = "Avg. Generation (MWh)", fill = "Natural Gas usage") +
scale_fill_manual(values = c("FALSE" = "lightblue", "TRUE" = '#f16161'), labels = c('Normal', 'Highest')) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
text = element_text(hjust = 1, family = 'Helvetica Neue'),
title = element_text(face = 'bold')
) +
scale_y_continuous(limits = c(0, 12000), breaks = seq(0, 12000, by = 2000))+
geom_text(data = filter(avg_gas_data, month == "lug"),
aes(x = month, y = avg_generation, label = round(avg_generation)),
vjust = -0.5, color = "black", size = 6)
ggplot(avg_gas_data, aes(x = factor(month), y = avg_generation, fill = as.character(highlight_flag))) +
geom_bar(stat = "identity", color = "darkblue")+
geom_smooth(method = "loess", color = "red", size = 1, span = 0.7) +  # Adjust span
labs(x = "Month", y = "Avg. Generation (MWh)", fill = "Natural Gas usage") +
scale_fill_manual(values = c("FALSE" = "lightblue", "TRUE" = '#f16161'), labels = c('Normal', 'Highest')) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
text = element_text(hjust = 1, family = 'Helvetica Neue'),
title = element_text(face = 'bold')
) +
scale_y_continuous(limits = c(0, 12000), breaks = seq(0, 12000, by = 2000))+
geom_text(data = filter(avg_gas_data, month == "lug"),
aes(x = month, y = avg_generation, label = round(avg_generation)),
vjust = -0.5, color = "black", size = 6)
ggplot(avg_gas_data, aes(x = factor(month), y = avg_generation, fill = as.character(highlight_flag))) +
geom_bar(stat = "identity", color = "darkblue")+
labs(x = "Month", y = "Avg. Generation (MWh)", fill = "Natural Gas usage") +
scale_fill_manual(values = c("FALSE" = "lightblue", "TRUE" = '#f16161'), labels = c('Normal', 'Highest')) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
text = element_text(hjust = 1, family = 'Helvetica Neue'),
title = element_text(face = 'bold')
) +
scale_y_continuous(limits = c(0, 12000), breaks = seq(0, 12000, by = 2000))+
geom_text(data = filter(avg_gas_data, month == "lug"),
aes(x = month, y = avg_generation, label = round(avg_generation)),
vjust = -0.5, color = "black", size = 6)
ggplot(avg_gas_data, aes(x = factor(month), y = avg_generation, fill = as.character(highlight_flag))) +
geom_bar(stat = "identity", color = "darkblue")+
labs(x = "Month", y = "Avg. Generation (MWh)", fill = "Natural Gas usage") +
scale_fill_manual(values = c("FALSE" = "lightblue", "TRUE" = '#f16161'), labels = c('Normal', 'Highest')) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.line = element_line(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
text = element_text(hjust = 1, family = 'Helvetica Neue'),
title = element_text(face = 'bold')
) +
scale_y_continuous(limits = c(0, 12000), breaks = seq(0, 12000, by = 2000))+
geom_text(data = filter(avg_gas_data, month == "lug"),
aes(x = month, y = avg_generation, label = round(avg_generation)),
vjust = -0.5, color = "black", size = 6)
combined_data = rbind(avg_data, pre2011_avg_pet_data)
combined_data = rbind(combined_data, post2011_avg_ren_data)
combined_data = rbind(combined_data, avg_gas_data)
print(n=30, combined_data)
ggplot(combined_data, aes(fill = energysource, y = avg_generation, x = month)) +
geom_bar(position = 'dodge', stat = 'identity') +
scale_fill_manual(values = c("All" = "grey", "Petroleum" = "lightblue", "Renewables" = "green", 'Gas'='orange')) +
labs(
title = "Average Generation",
x = "Month",
y = "Average Generation (MWh)",
fill = "Energy Source"
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1, family = 'Lato'),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(face = "bold", family = 'Lato'),
axis.text.y = element_text(hjust = 1, family = 'Lato')
)+
scale_y_continuous(limits = c(0, 40000), breaks = seq(0, 40000, by = 5000))
